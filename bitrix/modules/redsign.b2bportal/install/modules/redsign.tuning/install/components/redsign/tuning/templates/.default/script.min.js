!function(e,t){"use strict";function i(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var s={containerId:"rstuning",animationDelay:310,sidebarWidth:415,contentWidth:650,selectors:{sidebar:".js-rstuning__sidebar",content:".js-rstuning__content",preloader:".js-rstuning__preloader",openButton:".js-rstuning__open-button",closeButton:".js-rstuning__close-button",mainOverlay:".js-rstuning__main-overlay",contentOverlay:".js-rstuning__content-overlay",toggleSidebar:".js-rstuning__toggle-sidebar",defaultSettings:".js-tuning-default-settings"},breakpoint:{top:1065,low:320}},o=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return babelHelpers.classCallCheck(this,t),e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this)),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"container",null),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"modTabs",!1),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"keyCode",{ESC:27}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"swipeData",{touchDown:!1,originalPosition:null,el:2,result:{}}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"request",{delay:800,timeoutId:0}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"isMobile",{Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}}),e.options=n(n({},s),i),document.addEventListener("DOMContentLoaded",e.init.bind(babelHelpers.assertThisInitialized(e))),window.addEventListener("resize",e.windowResize.bind(babelHelpers.assertThisInitialized(e))),e}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"init",value:function(){if(this.container=document.getElementById(this.options.containerId),this.container){var e=[],t=0;if(this.modTabs=!!document.querySelector(".js-rstuning.mod-tabs"),this.container.classList.add("rstuning__loaded"),this.setWidth(),this.container.classList.contains("open")&&document.querySelector("html").classList.toggle("rstuning-enabled"),this.container.querySelector(this.options.selectors.openButton).addEventListener("click",this.closeopen.bind(this)),this.container.querySelector(this.options.selectors.closeButton).addEventListener("click",this.closeopen.bind(this)),document.querySelector(this.options.selectors.mainOverlay).addEventListener("click",this.closeopen.bind(this)),this.isMobile.iOS()||(this.container.addEventListener("touchstart",this.touchStart.bind(this)),this.container.addEventListener("touchend",this.touchEnd.bind(this)),this.container.addEventListener("touchmove",this.touchMove.bind(this))),this.modTabs){if((e=this.container.querySelectorAll(this.options.selectors.toggleSidebar))&&e.length>0)for(t=0;t<e.length;t++)e[t].addEventListener("click",this.toggleSidebar.bind(this));this.container.querySelector(this.options.selectors.contentOverlay).addEventListener("click",this.toggleSidebar.bind(this))}if((e=this.container.querySelectorAll(this.options.selectors.defaultSettings))&&e.length>0)for(t=0;t<e.length;t++)e[t].addEventListener("click",this.restoreDefaultSettings.bind(this));if((e=this.container.querySelectorAll("[data-macros]"))&&e.length>0)for(t=0;t<e.length;t++)e[t].addEventListener("change",this.changeMacrosFields.bind(this));if((e=this.container.querySelectorAll("input"))&&e.length>0)for(t=0;t<e.length;t++)e[t].addEventListener("change",this.changeField.bind(this));if((e=this.container.querySelectorAll("select"))&&e.length>0)for(t=0;t<e.length;t++)e[t].addEventListener("change",this.changeField.bind(this));if((e=this.container.querySelectorAll("textarea"))&&e.length>0)for(t=0;t<e.length;t++)e[t].addEventListener("change",this.changeField.bind(this));if((e=this.container.querySelectorAll(".js-rstuning-nav"))&&e.length>0)for(t=0;t<e.length;t++)e[t].addEventListener("click",this.switchTab.bind(this));if(this.container.querySelector("form")?this.container.querySelector("form").addEventListener("submit",this.formSubmit.bind(this)):console.warn("No form detected! Cant save settings."),(e=this.container.querySelectorAll(".rstuning__scroll"))&&e.length>0)for(t=0;t<e.length;t++)e[t].addEventListener("wheel",(function(e){e.stopPropagation()}));return!0}}},{key:"windowResize",value:function(){return this.setWidth(),!0}},{key:"closeopen",value:function(e){var t=this,i=!this.container.classList.contains("open");return document.querySelector("html").classList.toggle("rstuning-enabled"),i?(BX.setCookie("RSTUNING_COOKIE_OPEN","Y"),this.container.classList.remove("closed"),setTimeout((function(){t.container.classList.add("open"),window.addEventListener("keyup",t.windowKeyUp.bind(t))}),10)):(BX.setCookie("RSTUNING_COOKIE_OPEN","N"),this.container.classList.remove("open"),this.container.classList.remove("loading"),this.container.classList.remove("open-sidebar"),setTimeout((function(){t.container.classList.add("closed"),window.removeEventListener("keyup",t.windowKeyUp.bind(t))}),this.options.animationDelay)),this.modTabs&&(this.container.classList.remove("open-sidebar"),this.container.querySelector(this.options.selectors.contentOverlay).classList.remove("open")),this.setWidth(),e&&e.preventDefault(),!0}},{key:"windowKeyUp",value:function(e){e.keyCode==this.keyCode.ESC&&this.closeopen()}},{key:"toggleSidebar",value:function(){return!!this.modTabs&&(this.container.classList.toggle("open-sidebar"),this.container.querySelector(this.options.selectors.contentOverlay).classList.toggle("open"),!0)}},{key:"changeMacrosFields",value:function(e){var t=window.rsTuning;return t.setMacros(e.target.getAttribute("data-macros"),e.target.value),e.target.getAttribute("data-tuning-color-macros")&&t.setMacros(e.target.getAttribute("data-tuning-color-macros"),e.target.value),t.generateCss(),!0}},{key:"changeField",value:function(e){for(var t=e.target;(t=t.parentElement)&&!t.classList.contains("js-rs_option_info"););return t&&"Y"==t.getAttribute("data-reload")&&this.container.setAttribute("data-reload","Y"),this.formSubmit(),!0}},{key:"switchTab",value:function(e){var t=e.currentTarget,i=t.getAttribute("data-tabid"),n=this.container.querySelector('.js-rstuning__tab-content [data-tabid="'+i+'"]'),s=!1,o=[],r=0;if(n&&i){for(BX.onCustomEvent(window,"rs.tuning.tabs.before.change",[n]),this.container.querySelector(".js-content-title")>0&&(this.container.querySelector(".js-content-title").innerHTML=t.getAttribute("data-name")),s=t;(s=s.parentElement)&&!s.classList.contains("js-rstuning__tab-switcher"););if(s&&(o=s.querySelectorAll("a"))&&o.length>0)for(r=0;r<o.length;r++)o[r].classList.remove("active");for(t.classList.add("active"),s=n;(s=s.parentElement)&&!s.classList.contains("js-rstuning__tab-content"););if(s&&(o=s.querySelectorAll(".js-rstuning__tab-pane"))&&o.length>0)for(r=0;r<o.length;r++)o[r].classList.remove("active");return n.classList.add("active"),BX.setCookie("RSTUNING_COOKIE_TAB_ACTIVE",i),this.container.classList.remove("open-sidebar"),document.querySelector(this.options.selectors.contentOverlay).classList.remove("open"),BX.onCustomEvent(window,"rs.tuning.tabs.after.change",[n]),!0}}},{key:"formSubmit",value:function(){var e=this,t=this.container.querySelector("form"),i=new XMLHttpRequest,n=new FormData(t);return clearTimeout(this.request.timeoutId),this.request.timeoutId=setTimeout((function(){e.loading(),i.open("POST",t.getAttribute("action"),!1),i.addEventListener("load",e.requestCallback.bind(e)),i.send(n)}),this.request.delay),!0}},{key:"requestCallback",value:function(e){var t=this;if(200!=e.currentTarget.status)console.error(e.currentTarget.status+": "+e.currentTarget.statusText);else if("Y"==this.container.getAttribute("data-reload"))window.location.reload();else{var i=JSON.parse(e.currentTarget.response);this.emit("Redsign.Tuning.Component:afterResponse",i),setTimeout((function(){t.loading()}),1500)}return!0}},{key:"restoreDefaultSettings",value:function(e){var t=this.container.querySelector("form"),i=new XMLHttpRequest,n="site_id="+this.container.getAttribute("data-siteid")+"&rstuning_ajax=Y&rstuning_action=restoredefaultsettings";return this.container.setAttribute("data-reload","Y"),this.loading(),i.open("POST",t.getAttribute("action"),!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.addEventListener("load",this.requestCallback.bind(this)),i.send(n),!0}},{key:"swipe",value:function(e){var t,i,n=0,s=0;return e&&e.touches[0]?(n=e.touches[0].pageX,s=e.touches[0].pageY):e&&e.originalEvent&&e.originalEvent.touches[0]?(n=e.originalEvent.touches[0].pageX,s=e.originalEvent.touches[0].pageY):e&&e.changedTouches[0]?(n=e.changedTouches[0].pageX,s=e.changedTouches[0].pageY):console.warn("TuningComponent: swipe - no coordinates"),t=Math.abs(this.swipeData.originalPosition.x-n)>80?n>this.swipeData.originalPosition.x?"right":"left":null,i=Math.abs(this.swipeData.originalPosition.y-s)>80?s>this.swipeData.originalPosition.y?"down":"up":null,this.swipeData.result={direction:{x:t,y:i},offset:{x:n-this.swipeData.originalPosition.x,y:this.swipeData.originalPosition.y-s}},!0}},{key:"touchStart",value:function(e){return this.swipeData.touchDown=!0,e&&e.touches[0]?this.swipeData.originalPosition={x:e.touches[0].pageX,y:e.touches[0].pageY}:e&&e.originalEvent&&e.originalEvent.touches[0]?this.swipeData.originalPosition={x:e.originalEvent.touches[0].pageX,y:e.originalEvent.touches[0].pageY}:e&&e.changedTouches[0]?this.swipeData.originalPosition={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY}:console.error("TuningComponent: touch coordinates get error."),!0}},{key:"touchEnd",value:function(e){return this.swipe(e),this.swipeData.touchDown=!1,this.swipeData.originalPosition=null,"right"==this.swipeData.result.direction.x&&this.container.classList.contains("open")||"left"==this.swipeData.result.direction.x&&this.container.classList.contains("open-sidebar")?this.toggleSidebar():"left"!=this.swipeData.result.direction.x||this.container.classList.contains("open-sidebar")||this.closeopen(),!0}},{key:"touchMove",value:function(e){this.swipeData.touchDown}},{key:"setWidth",value:function(){return window.innerWidth<=this.options.breakpoint.top?(this.container.querySelector(this.options.selectors.preloader).style.width=Math.min(this.options.sidebarWidth+this.options.contentWidth,window.innerWidth)+"px",this.container.querySelector(this.options.selectors.sidebar).style.width=Math.min(this.options.sidebarWidth,window.innerWidth)+"px",this.container.querySelector(this.options.selectors.content).style.width=Math.min(this.options.contentWidth,window.innerWidth)+"px"):(this.container.querySelector(this.options.selectors.sidebar).style.width="",this.container.querySelector(this.options.selectors.content).style.width=""),this.modTabs&&(this.container.classList.remove("open-sidebar"),this.container.querySelector(this.options.selectors.contentOverlay).classList.remove("open")),!0}},{key:"loading",value:function(){return"Y"==this.container.getAttribute("data-reload")&&this.container.classList.toggle("loading"),!0}},{key:"getTuningComponent",value:function(){return this.container}}]),t}(t.Event.EventEmitter);babelHelpers.defineProperty(o,"instance",null),e.TuningComponent=o}(this.RS=this.RS||{},BX);