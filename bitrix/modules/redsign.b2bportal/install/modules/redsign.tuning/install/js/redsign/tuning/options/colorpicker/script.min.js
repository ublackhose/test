!function(e){"use strict";var t=[],i=[];function r(e,r){if(r=r||{},void 0===e)throw new Error("insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).");var n,s=!0===r.prepend?"prepend":"append",o=void 0!==r.container?r.container:document.querySelector("head"),a=t.indexOf(o);return-1===a&&(a=t.push(o)-1,i[a]={}),void 0!==i[a]&&void 0!==i[a][s]?n=i[a][s]:(n=i[a][s]=function(){var e=document.createElement("style");return e.setAttribute("type","text/css"),e}(),"prepend"===s?o.insertBefore(n,o.childNodes[0]):o.appendChild(n)),65279===e.charCodeAt(0)&&(e=e.substr(1,e.length)),n.styleSheet?n.styleSheet.cssText+=e:n.textContent+=e,n}var n=r;function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),e}function a(e){return"number"==typeof e&&!isNaN(e)}function h(e,t,i){return Math.min(Math.max(e,t),i)}function u(e){if(0===e.type.indexOf("touch")){var t=e.touches[0];return{x:t.clientX,y:t.clientY}}return{x:e.clientX,y:e.clientY}}function l(e){return 1==e.length?"0"+e:""+e}r.insertCss=n;var c=function(){function e(e){this._rgba={r:0,g:0,b:0,a:1},this._hsva={h:0,s:0,v:0,a:1},this.fromHex(e)}var t=e.prototype;return t.fromHex=function(e){e||(e=0),a(e)?(this._hexNumber=e,this._hexString=function(e){return"#"+("00000"+(0|e).toString(16)).substr(-6).toUpperCase()}(this._hexNumber)):(this._hexString=e.toUpperCase(),this._hexNumber=d(this._hexString));var t=function(e){return{r:(e>>16&255)/255,g:(e>>8&255)/255,b:(255&e)/255}}(this._hexNumber),i=t.g,r=t.b;this._rgba.r=t.r,this._rgba.g=i,this._rgba.b=r;var n=function(e){var t,i=e.r,r=e.g,n=e.b,s=Math.max(i,r,n),o=Math.min(i,r,n),a=s-o,h=0===s?0:a/s,u=s;if(s==o)t=0;else{switch(s){case i:t=(r-n)/a+(r<n?6:0);break;case r:t=(n-i)/a+2;break;case n:t=(i-r)/a+4}t/=6}return{h:t,s:h,v:u}}(this._rgba),s=n.s,o=n.v;this._hsva.h=n.h,this._hsva.s=s,this._hsva.v=o,this._updateBrightness()},t.fromHsv=function(e){var t=e.s,i=e.v;this._hsva.h=e.h,this._hsva.s=t,this._hsva.v=i;var r=function(e){var t=e.h,i=e.s,r=e.v;t*=6;var n=Math.floor(t),s=t-n,o=r*(1-i),a=r*(1-s*i),h=r*(1-(1-s)*i),u=n%6;return{r:[r,a,o,o,h,r][u],g:[h,r,r,a,o,o][u],b:[o,o,h,r,r,a][u]}}(this._hsva),n=r.g,s=r.b;this._rgba.r=r.r,this._rgba.g=n,this._rgba.b=s,this._hexString=function(e){var t=e.g,i=e.b;return["#",l(Math.round(255*e.r).toString(16)),l(Math.round(255*t).toString(16)),l(Math.round(255*i).toString(16))].join("").toUpperCase()}(this._rgba),this._hexNumber=d(this._hexString),this._updateBrightness()},t._updateBrightness=function(){var e=this._rgba;this._brightness=(299*e.r+587*e.g+114*e.b)/1e3,this._isDark=this._brightness<.5,this._isLight=!this._isDark},o(e,[{key:"rgb",get:function(){return this._rgba}},{key:"hsv",get:function(){return this._hsva}},{key:"hex",get:function(){return this._hexNumber}},{key:"hexString",get:function(){return this._hexString}},{key:"brightness",get:function(){return this._brightness}},{key:"isDark",get:function(){return this._isDark}},{key:"isLight",get:function(){return this._isLight}}]),e}();function d(e){return parseInt(e.replace("#",""),16)}var v=function(){function e(e){var t=this;void 0===e&&(e={}),this._widthUnits="px",this._heightUnits="px",this._huePosition=0,this._hueHeight=0,this._maxHue=0,this._inputIsNumber=!1,this._saturationWidth=0,this._isChoosing=!1,this._callbacks=[],this.width=0,this.height=0,this.hue=0,this.position={x:0,y:0},this.color=new c(0),this.backgroundColor=new c(0),this.hueColor=new c(0),this._onSaturationMouseDown=function(e){var i=t.$saturation.getBoundingClientRect(),r=u(e),n=r.x,s=r.y;t._isChoosing=!0,t._moveSelectorTo(n-i.left,s-i.top),t._updateColorFromPosition(),t._window.addEventListener("mouseup",t._onSaturationMouseUp),t._window.addEventListener("touchend",t._onSaturationMouseUp),t._window.addEventListener("mousemove",t._onSaturationMouseMove),t._window.addEventListener("touchmove",t._onSaturationMouseMove),e.preventDefault()},this._onSaturationMouseMove=function(e){var i=t.$saturation.getBoundingClientRect(),r=u(e);t._moveSelectorTo(r.x-i.left,r.y-i.top),t._updateColorFromPosition()},this._onSaturationMouseUp=function(){t._isChoosing=!1,t._window.removeEventListener("mouseup",t._onSaturationMouseUp),t._window.removeEventListener("touchend",t._onSaturationMouseUp),t._window.removeEventListener("mousemove",t._onSaturationMouseMove),t._window.removeEventListener("touchmove",t._onSaturationMouseMove)},this._onHueMouseDown=function(e){var i=t.$hue.getBoundingClientRect(),r=u(e).y;t._isChoosing=!0,t._moveHueTo(r-i.top),t._updateHueFromPosition(),t._window.addEventListener("mouseup",t._onHueMouseUp),t._window.addEventListener("touchend",t._onHueMouseUp),t._window.addEventListener("mousemove",t._onHueMouseMove),t._window.addEventListener("touchmove",t._onHueMouseMove),e.preventDefault()},this._onHueMouseMove=function(e){var i=t.$hue.getBoundingClientRect(),r=u(e);t._moveHueTo(r.y-i.top),t._updateHueFromPosition()},this._onHueMouseUp=function(){t._isChoosing=!1,t._window.removeEventListener("mouseup",t._onHueMouseUp),t._window.removeEventListener("touchend",t._onHueMouseUp),t._window.removeEventListener("mousemove",t._onHueMouseMove),t._window.removeEventListener("touchmove",t._onHueMouseMove)},this._window=e.window||window,this._document=this._window.document,this.$el=this._document.createElement("div"),this.$el.className="Scp",this.$el.innerHTML='\n      <div class="Scp-saturation">\n        <div class="Scp-brightness"></div>\n        <div class="Scp-sbSelector"></div>\n      </div>\n      <div class="Scp-hue">\n        <div class="Scp-hSelector"></div>\n      </div>\n    ',this.$saturation=this.$el.querySelector(".Scp-saturation"),this.$hue=this.$el.querySelector(".Scp-hue"),this.$sbSelector=this.$el.querySelector(".Scp-sbSelector"),this.$hSelector=this.$el.querySelector(".Scp-hSelector"),this.$saturation.addEventListener("mousedown",this._onSaturationMouseDown),this.$saturation.addEventListener("touchstart",this._onSaturationMouseDown),this.$hue.addEventListener("mousedown",this._onHueMouseDown),this.$hue.addEventListener("touchstart",this._onHueMouseDown),e.el&&this.appendTo(e.el),e.background&&this.setBackgroundColor(e.background),e.widthUnits&&(this._widthUnits=e.widthUnits),e.heightUnits&&(this._heightUnits=e.heightUnits),this.setSize(e.width||175,e.height||150),this.setColor(e.color)}var t=e.prototype;return t.appendTo=function(e){return"string"==typeof e?document.querySelector(e).appendChild(this.$el):e.appendChild(this.$el),this},t.remove=function(){this._callbacks=[],this._onSaturationMouseUp(),this._onHueMouseUp(),this.$saturation.removeEventListener("mousedown",this._onSaturationMouseDown),this.$saturation.removeEventListener("touchstart",this._onSaturationMouseDown),this.$hue.removeEventListener("mousedown",this._onHueMouseDown),this.$hue.removeEventListener("touchstart",this._onHueMouseDown),this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},t.setColor=function(e){this._inputIsNumber=a(e),this.color.fromHex(e);var t=this.color.hsv,i=t.h,r=t.s,n=t.v;return isNaN(i)||(this.hue=i),this._moveSelectorTo(this._saturationWidth*r,(1-n)*this._hueHeight),this._moveHueTo((1-this.hue)*this._hueHeight),this._updateHue(),this},t.setSize=function(e,t){return this.width=e,this.height=t,this.$el.style.width=this.width+this._widthUnits,this.$el.style.height=this.height+this._heightUnits,this._saturationWidth=this.width-25,this.$saturation.style.width=this._saturationWidth+"px",this._hueHeight=this.height,this._maxHue=this._hueHeight-2,this},t.setBackgroundColor=function(e){return this.backgroundColor.fromHex(e),this.$el.style.padding="5px",this.$el.style.background=this.backgroundColor.hexString,this},t.setNoBackground=function(){return this.$el.style.padding="0px",this.$el.style.background="none",this},t.onChange=function(e){return this._callbacks.indexOf(e)<0&&(this._callbacks.push(e),e(this.getHexString())),this},t.getColor=function(){return this._inputIsNumber?this.getHexNumber():this.getHexString()},t.getHexString=function(){return this.color.hexString.toUpperCase()},t.getHexNumber=function(){return this.color.hex},t.getRGB=function(){return this.color.rgb},t.getHSV=function(){return this.color.hsv},t.isDark=function(){return this.color.isDark},t.isLight=function(){return this.color.isLight},t._moveSelectorTo=function(e,t){this.position.x=h(e,0,this._saturationWidth),this.position.y=h(t,0,this._hueHeight),this.$sbSelector.style.transform="translate("+this.position.x+"px, "+this.position.y+"px)"},t._updateColorFromPosition=function(){this.color.fromHsv({h:this.hue,s:this.position.x/this._saturationWidth,v:1-this.position.y/this._hueHeight}),this._updateColor()},t._moveHueTo=function(e){this._huePosition=h(e,0,this._maxHue),this.$hSelector.style.transform="translateY("+this._huePosition+"px)"},t._updateHueFromPosition=function(){var e=this.getHSV();this.hue=1-this._huePosition/this._maxHue,this.color.fromHsv({h:this.hue,s:e.s,v:e.v}),this._updateHue()},t._updateHue=function(){this.hueColor.fromHsv({h:this.hue,s:1,v:1}),this.$saturation.style.background="linear-gradient(to right, #fff, "+this.hueColor.hexString+")",this._updateColor()},t._updateColor=function(){this.$sbSelector.style.background=this.getHexString(),this.$sbSelector.style.borderColor=this.isDark()?"#fff":"#000",this._triggerChange()},t._triggerChange=function(){var e=this;this._callbacks.forEach((function(t){return t(e.getHexString())}))},o(e,[{key:"isChoosing",get:function(){return this._isChoosing}}]),e}();n(".Scp{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative}.Scp-saturation{position:relative;height:100%;background:linear-gradient(90deg,#fff,red);float:left;margin-right:5px}.Scp-brightness{width:100%;height:100%;background:linear-gradient(hsla(0,0%,100%,0),#000)}.Scp-sbSelector{border:2px solid #fff;position:absolute;width:14px;height:14px;background:#fff;border-radius:10px;top:-7px;left:-7px;box-sizing:border-box;z-index:10}.Scp-hue{width:20px;height:100%;position:relative;float:left;background:linear-gradient(red,#f0f 17%,#00f 34%,#0ff 50%,#0f0 67%,#ff0 84%,red)}.Scp-hSelector{position:absolute;background:#fff;border-bottom:1px solid #000;right:-3px;width:10px;height:2px}");function f(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function p(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?f(Object(i),!0).forEach((function(t){babelHelpers.defineProperty(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):f(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function g(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}var b={containerId:"colorPickerId",color:"FFFFFF"},_=new WeakMap,S=new WeakMap,y=new WeakMap,m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,e),babelHelpers.defineProperty(this,"options",{}),babelHelpers.defineProperty(this,"container",null),babelHelpers.defineProperty(this,"colorPickerNode",null),babelHelpers.defineProperty(this,"fieldRed",null),babelHelpers.defineProperty(this,"fieldGreen",null),babelHelpers.defineProperty(this,"fieldBlue",null),babelHelpers.defineProperty(this,"fieldHex",null),babelHelpers.defineProperty(this,"colorPicker",null),babelHelpers.defineProperty(this,"variants",[]),babelHelpers.defineProperty(this,"sets",[]),g(this,_,{writable:!0,value:null}),g(this,S,{writable:!0,value:null}),g(this,y,{writable:!0,value:""}),this.options=p(p({},b),t),document.addEventListener("DOMContentLoaded",this.init.bind(this))}return babelHelpers.createClass(e,[{key:"activeSet",get:function(){return babelHelpers.classPrivateFieldGet(this,_)},set:function(e){if(babelHelpers.classPrivateFieldGet(this,_)!=e){if(this.sets.forEach((function(e){return e.classList.remove("active")})),!this.sets.includes(e))return babelHelpers.classPrivateFieldGet(this,_).classList.remove("active"),void babelHelpers.classPrivateFieldSet(this,_,null);babelHelpers.classPrivateFieldSet(this,_,e),e.classList.add("active");var t=JSON.parse(e.getAttribute("data-value")),i=Object.keys(t),r=null;for(var n in this.variants){var s=this.variants[n],o=s.getAttribute("data-valkey");i.includes(o)?(s.style.display="",this.setVariantColor(s,t[o]),i[0]==o&&(r=s)):s.style.display="none"}r&&(this.activeVariant=r)}}},{key:"activeVariant",get:function(){return babelHelpers.classPrivateFieldGet(this,S)},set:function(e){if(babelHelpers.classPrivateFieldGet(this,S)!=e){if(this.variants.forEach((function(e){return e.classList.remove("active")})),!this.variants.includes(e))throw new Error("Incorrected value");babelHelpers.classPrivateFieldSet(this,S,e),e.classList.add("active"),this.activeColor=e.querySelector("input").value}else this.activeColor=e.querySelector("input").value}},{key:"activeColor",get:function(){return babelHelpers.classPrivateFieldGet(this,y)},set:function(e){try{if(e=e.replace("#",""),babelHelpers.classPrivateFieldGet(this,y)==e)return;babelHelpers.classPrivateFieldSet(this,y,e),this.setColorFields(e),this.setVariantColor(this.activeVariant,e),this.colorPicker&&this.colorPicker.setColor(e);var t=JSON.stringify(this.getActiveScheme()).toUpperCase(),i=0;for(var r in this.sets){if(t==this.sets[r].getAttribute("data-value").toUpperCase()){this.activeSet=this.sets[r];break}i++}i==this.sets.length&&(this.activeSet=null)}catch(e){console.error(e.message)}}}]),babelHelpers.createClass(e,[{key:"init",value:function(){var e=this;if(this.container=document.getElementById(this.options.containerId),this.container){this.colorPickerNode=this.container.querySelector('[data-entity="colorpicker"]'),this.fieldRed=this.container.querySelector('[data-entity="field-red"]'),this.fieldGreen=this.container.querySelector('[data-entity="field-green"]'),this.fieldBlue=this.container.querySelector('[data-entity="field-blue"]'),this.fieldHex=this.container.querySelector('[data-entity="field-hex"]'),this.sets=babelHelpers.toConsumableArray(this.container.querySelectorAll('[data-entity="set-item"]')),this.variants=babelHelpers.toConsumableArray(this.container.querySelectorAll('[data-entity="variant"]'));var t=this.sets.filter((function(e){return e.classList.contains("active")}))[0];t?this.activeSet=t:this.activeVariant=this.variants.filter((function(e){return e.classList.contains("active")}))[0],this.variants&&this.variants.forEach((function(t){t.addEventListener("click",(function(t){var i=t.currentTarget;e.activeVariant=i}))})),this.sets&&this.sets.forEach((function(t){t.addEventListener("click",(function(t){var i=t.currentTarget;e.activeSet=i}))})),this.fieldHex&&["blur","input"].forEach((function(t){return e.fieldHex.addEventListener(t,BX.debounce((function(t){var i=t.target;e.activeColor=i.value}),500))})),[this.fieldRed,this.fieldGreen,this.fieldBlue].forEach((function(t){t&&["blur","input"].forEach((function(i){return t.addEventListener(i,BX.debounce((function(){e.activeColor=function(e,t,i){return((1<<24)+(parseInt(e,10)<<16)+(parseInt(t,10)<<8)+parseInt(i,10)).toString(16).slice(1)}(e.fieldRed.value,e.fieldGreen.value,e.fieldBlue.value)}),500))}))})),this.fieldHex&&["blur","keyup"].forEach((function(t){return e.fieldHex.addEventListener(t,BX.debounce((function(t){var i=t.target;e.activeColor=i.value}),500))})),this.colorPickerNode&&(this.colorPicker=new v({el:this.colorPickerNode,color:this.options.color}),this.colorPicker&&(this.setColorPickerSize(),this.colorPicker.onChange((function(){var t=e.colorPicker.getHexString();e.activeColor=t})),window.addEventListener("resize",BX.debounce((function(){e.setColorPickerSize()}),200)))),this.isVisible()||BX.addCustomEvent("rs.tuning.tabs.after.change",this.setColorPickerSize.bind(this))}}},{key:"setColorPickerSize",value:function(){if(this.colorPicker){var e=getComputedStyle(this.colorPickerNode),t=parseInt(e.height,10),i=parseInt(e.width,10);this.colorPicker.setSize(i,t),this.colorPicker.setColor(this.colorPicker.getHexString())}}},{key:"setColorFields",value:function(e){var t=function(e){if(!e)throw new Error("Incorrected value");if(3==(e=e.replace("#","")).length)e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2];else if(6!=e.length)throw new Error("Incorrected value");return{r:parseInt(e[0]+e[1],16),g:parseInt(e[2]+e[3],16),b:parseInt(e[4]+e[5],16)}}(e);this.fieldRed&&(this.fieldRed.value=Math.round(t.r)),this.fieldGreen&&(this.fieldGreen.value=Math.round(t.g)),this.fieldBlue&&(this.fieldBlue.value=Math.round(t.b)),this.fieldHex&&(this.fieldHex.value=e.replace("#",""))}},{key:"isVisible",value:function(){return null!==this.container.offsetParent}},{key:"setVariantColor",value:function(e,t){var i=e.querySelector("input");i&&(i.value=t,i.dispatchEvent(new Event("change")));var r=e.querySelector('[data-entity="variant-paint"]');r&&(r.style.backgroundColor="#"+t)}},{key:"getActiveScheme",value:function(){var e={};for(var t in this.variants)e[this.variants[t].getAttribute("data-valkey")]=this.variants[t].querySelector("input").value;return e}}]),e}();e.RedsignTuningOptionColor=m}(this.window=this.window||{});