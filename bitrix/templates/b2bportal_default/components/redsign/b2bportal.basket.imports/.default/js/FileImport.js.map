{"version":3,"file":"FileImport.js","sources":["../src/api.js","../src/FileImport.vue?rollup-plugin-vue=script.js","../../../../../node_modules/vue-runtime-helpers/dist/normalize-component.js","../src/FileImport.vue","../src/FileImport.js"],"sourcesContent":["export async function action(actionName, data)\n{\n\tvar resultData = undefined;\n\n\ttry\n\t{\n\t\tconst result = await new Promise((resolve, reject) => {\n\t\t\tBX.ajax.runComponentAction(\n\t\t\t\t'redsign:b2bportal.basket.imports',\n\t\t\t\tactionName,\n\t\t\t\t{ \n\t\t\t\t\tmode: 'class',\n\t\t\t\t\tdata: data,\n\t\t\t\t}\n\t\t\t).then(resolve, reject);\n\t\t});\n\n\t\tresultData = result.data;\n\t}\n\tcatch (e)\n\t{\n\t\tglobal.toastr.error(((e.errors || [])[0] || {}).message);\n\t\tthrow e;\n\t}\n\n\treturn resultData;\n};\n\nexport async function checkExistsCodes(data)\n{\n\treturn action('check', data);\n}\n\nexport async function addtobasket(data)\n{\n\treturn action('addtobasket', data)\n\t\t.then((result) => {\n\t\t\tBX.onCustomEvent('updateBasketComponent');\n\n\t\t\treturn result;\n\t\t});\n}\n\n\nexport async function parseFile(data)\n{\n\treturn action('parseFile', data);\n}","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { parseFile, addtobasket} from './api.js';\n\nexport default {\n\n\tcomponents: {\n\t\tStepper: B2BPortal.Vue.Components.Stepper\n\t},\n\n\tprops: {\n\t\tsignedParameters: {\n\t\t\ttype: String,\n\t\t\tdefault: ''\n\t\t}\n\t},\n\n\tdata()\n\t{\n\t\treturn {\n\t\t\tcurrentStepIndex: 0,\n\t\t\tsteps: Object.freeze([\n\t\t\t\t'step1',\n\t\t\t\t'step2',\n\t\t\t\t'step3'\n\t\t\t]),\n\t\t\tmethod: 'upload',\n\t\t\tfile: '',\n\t\t\tfilePath: '',\n\t\t\tfileRows: [],\n\t\t\tskipFirstRow: true,\n\t\t\tsettings: {\n\t\t\t\tcodeIndex: undefined,\n\t\t\t\tquantityIndex: undefined\n\t\t\t},\n\t\t\tresult: {}\n\t\t}\n\t},\n\n\tcomputed: {\n\n\t\tfileData()\n\t\t{\n\t\t\treturn {\n\t\t\t\thighestColumn: this.fileRows.reduce((highest, row) => Math.max(highest, row.length), 0)\n\t\t\t};\n\t\t},\n\n\t\tmessages()\n\t\t{\n\t\t\treturn (\n\t\t\t\tObject.freeze(\n\t\t\t\t\tObject.keys(BX.message).filter(message => message.startsWith('RS_B2BPORTAL_BI'))\n\t\t\t\t\t\t.reduce((obj, message) => { obj[message.slice(message)] = BX.message(message); return obj; }, {})\n\t\t\t\t)\n\t\t\t);\n\t\t},\n\t},\n\n\tmethods: {\n\t\treset()\n\t\t{\n\t\t\tthis.currentStepIndex = 0;\n\t\t\tthis.fileRows = [];\n\t\t\tthis.file = '';\n\t\t\tthis.filePath = '';\n\n\t\t\tthis.settings = {\n\t\t\t\tcodeIndex: undefined,\n\t\t\t\tquantityIndex: undefined\n\t\t\t}\n\n\t\t\tthis.result = {};\n\t\t},\n\n\t\tstartLoader()\n\t\t{\n\t\t\tthis.$emit('startLoader')\n\t\t},\n\n\t\tendLoader()\n\t\t{\n\t\t\tthis.$emit('endLoader')\n\t\t},\n\n\t\tvalidateFileInput()\n\t\t{\n\t\t\tconst fileInput = this.$refs.fileInput;\n\t\t\tconst file = (fileInput.files || [])[0];\n\n\t\t\tthis.filePath = fileInput.value;\n\n\t\t\tif (file)\n\t\t\t{\n\t\t\t\tfileInput.classList.remove('is-invalid');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfileInput.classList.add('is-invalid');\n\t\t\t}\n\t\t},\n\n\t\thandleStep(step)\n\t\t{\n\t\t\tthis.currentStepIndex = step.index;\n\t\t},\n\n\t\tasync next(step)\n\t\t{\n\t\t\tswitch(step.name)\n\t\t\t{\n\t\t\t\tcase 'step1':\n\n\t\t\t\t\ttry \n\t\t\t\t\t{\n\t\t\t\t\t\tthis.startLoader();\n\n\t\t\t\t\t\tif (await this.processReadFile())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstep.next();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {}\n\t\t\t\t\tfinally\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.endLoader();\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'step2':\n\n\t\t\t\t\ttry \n\t\t\t\t\t{\n\t\t\t\t\t\tthis.startLoader();\n\t\t\t\t\t\tstep.next();\n\t\t\t\t\t\tawait this.addtobasket();\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {}\n\t\t\t\t\tfinally\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.endLoader();\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n\t\tasync back(step)\n\t\t{\n\t\t\tstep.back();\n\t\t},\n\n\t\tasync processReadFile()\n\t\t{\n\t\t\tif (this.method === 'upload')\n\t\t\t{\n\t\t\t\treturn this.processReadFileByUpload();\n\t\t\t}\n\t\t\telse if (this.method === 'link')\n\t\t\t{\n\t\t\t\treturn this.processReadFileByPath();\n\t\t\t}\n\n\t\t\tthrow new Error('Wrong file upload method');\n\t\t},\n\n\t\tasync processReadFileByUpload()\n\t\t{\n\t\t\tconst fileInput = this.$refs.fileInput;\n\t\t\tconst file = (fileInput.files || [])[0];\n\n\t\t\tif (file)\n\t\t\t{\n\t\t\t\tconst formData = new FormData();\n\t\t\t\tformData.append('file', file);\n\t\t\t\tformData.append('signedParamaters', this.signedParameters);\n\t\t\t\tformData.append('sessid', BX.bitrix_sessid());\n\n\t\t\t\tthis.fileRows = await parseFile(formData);\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfileInput.classList.add('is-invalid');\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\n\t\tasync processReadFileByPath()\n\t\t{\n\t\t\tthis.fileRows = await parseFile({\n\t\t\t\tpath: this.filePath,\n\t\t\t\tsignedParameters: this.signedParameters\n\t\t\t});\n\n\t\t\treturn true;\n\t\t},\n\n\t\tprepareData()\n\t\t{\n\t\t\tlet data = {};\n\t\t\tconst rows=  [...this.fileRows];\n\n\t\t\tif (this.skipFirstRow)\n\t\t\t{\n\t\t\t\trows.shift();\n\t\t\t}\n\n\t\t\tfor (const row of rows)\n\t\t\t{\n\t\t\t\tconst codeStr = new String(row[this.settings.codeIndex - 1]);\n\t\t\t\tif (codeStr.trim() !== '')\n\t\t\t\t{\n\t\t\t\t\tdata[codeStr] = row[this.settings.quantityIndex - 1];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn data;\n\t\t},\n\n\t\tasync addtobasket()\n\t\t{\n\t\t\tif (this.fileRows.length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst data = this.prepareData();\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst result = await addtobasket({\n\t\t\t\t\tdata: data,\n\t\t\t\t\tsignedParameters: this.signedParameters\t\n\t\t\t\t});\n\t\n\t\t\t\tthis.result = result;\n\t\t\t\tthis.$store.dispatch('cart/fetch');\n\t\t\t}\n\t\t\tcatch(e)\n\t\t\t{\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t}\n\t},\n\n\twatch: {\n\t\tfileRows(newVal)\n\t\t{\n\t\t\tif (this.fileRows.length > 0)\n\t\t\t{\n\t\t\t\tif ( this.fileRows[0].length === 5)\n\t\t\t\t{\n\t\t\t\t\t// default export\n\t\t\t\t\tthis.settings.codeIndex = 2;\n\t\t\t\t\tthis.settings.quantityIndex = 4;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.settings.codeIndex = this.fileRows[0].length > 0 ? 1 : undefined\n\t\t\t\t\tthis.settings.quantityIndex = this.fileRows[0].length > 1 ? 2 : undefined\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n} \n","'use strict';\n\nfunction normalizeComponent(template, style, script, scopeId, isFunctionalTemplate, moduleIdentifier\n/* server only */\n, shadowMode, createInjector, createInjectorSSR, createInjectorShadow) {\n  if (typeof shadowMode !== 'boolean') {\n    createInjectorSSR = createInjector;\n    createInjector = shadowMode;\n    shadowMode = false;\n  } // Vue.extend constructor export interop.\n\n\n  var options = typeof script === 'function' ? script.options : script; // render functions\n\n  if (template && template.render) {\n    options.render = template.render;\n    options.staticRenderFns = template.staticRenderFns;\n    options._compiled = true; // functional template\n\n    if (isFunctionalTemplate) {\n      options.functional = true;\n    }\n  } // scopedId\n\n\n  if (scopeId) {\n    options._scopeId = scopeId;\n  }\n\n  var hook;\n\n  if (moduleIdentifier) {\n    // server build\n    hook = function hook(context) {\n      // 2.3 injection\n      context = context || // cached call\n      this.$vnode && this.$vnode.ssrContext || // stateful\n      this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext; // functional\n      // 2.2 with runInNewContext: true\n\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__;\n      } // inject component styles\n\n\n      if (style) {\n        style.call(this, createInjectorSSR(context));\n      } // register component module identifier for async chunk inference\n\n\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier);\n      }\n    }; // used by ssr in case component is cached and beforeCreate\n    // never gets called\n\n\n    options._ssrRegister = hook;\n  } else if (style) {\n    hook = shadowMode ? function () {\n      style.call(this, createInjectorShadow(this.$root.$options.shadowRoot));\n    } : function (context) {\n      style.call(this, createInjector(context));\n    };\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // register for functional component in vue file\n      var originalRender = options.render;\n\n      options.render = function renderWithStyleInjection(h, context) {\n        hook.call(context);\n        return originalRender(h, context);\n      };\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate;\n      options.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n    }\n  }\n\n  return script;\n}\n\nmodule.exports = normalizeComponent;\n//# sourceMappingURL=normalize-component.js.map\n","<template>\n\n\t<Stepper :steps=\"steps\" :currentStep=\"currentStepIndex\" @onStep=\"handleStep\">\n\n\t\t<template v-slot:step1=\"step\">\n\n\t\t\t<div class=\"form-group\">\n\n\t\t\t\t{{messages.RS_B2BPORTAL_BI_FILE_IMPORT_STEP_1 }}<br><br>\n\t\t\t\t<ul class=\"nav nav-pills mb-3\">\n\t\t\t\t\t<li class=\"nav-item\">\n\t\t\t\t\t\t<a \n\t\t\t\t\t\t\tclass=\"nav-link\"\n\t\t\t\t\t\t\t:class=\"{active: method === 'upload'}\"  \n\t\t\t\t\t\t\thref=\"#\" \n\t\t\t\t\t\t\trole=\"tab\"\n\t\t\t\t\t\t\t@click.prevent=\"method = 'upload'\">\n\t\t\t\t\t\t\t{{ messages.RS_B2BPORTAL_BI_FILE_IMPORT_UPLOAD }}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"nav-item\">\n\t\t\t\t\t\t<a \n\t\t\t\t\t\t\tclass=\"nav-link\" \n\t\t\t\t\t\t\t:class=\"{active: method === 'link'}\" \n\t\t\t\t\t\t\thref=\"#\" \n\t\t\t\t\t\t\t@click.prevent=\"method = 'link'\">\n\t\t\t\t\t\t\t{{ messages.RS_B2BPORTAL_BI_FILE_IMPORT_LINK}}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\n\t\t\t\t<transition name=\"fade\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div v-show=\"method === 'upload'\">\n\t\t\t\t\t\t\t<label>{{ messages.RS_B2BPORTAL_BI_FILE_IMPORT_SELECT_FILE }}</label>\n\t\t\t\t\t\t\t<div></div>\n\t\t\t\t\t\t\t<div class=\"custom-file\">\n\t\t\t\t\t\t\t\t<input type=\"file\" class=\"custom-file-input\" ref=\"fileInput\" @change.prevent=\"validateFileInput\">\n\t\t\t\t\t\t\t\t<label class=\"custom-file-label\" for=\"customFile\" :data-browse=\"messages.RS_B2BPORTAL_BI_BROWSE\">{{ filePath }}</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-show=\"method === 'link'\">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t\t<label> {{ messages.RS_B2BPORTAL_BI_FILE_IMPORT_DOCUMENT_LINK }} </label>\n\t\t\t\t\t\t\t\t<input type=\"text\" class=\"form-control\" placeholder=\"https://example.com/file.csv\" v-model=\"filePath\">\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</transition>\n\t\t\t</div>\n\n\t\t\t<a class=\"btn btn-primary pull-right\" @click.prevent.stop=\"next(step)\" href=\"#\"> {{messages.RS_B2BPORTAL_BI_FILE_IMPORT_NEXT}} </a>\n\t\t</template>\n\n\t\t<template v-slot:step2=\"step\">\n\t\t\t{{ messages.RS_B2BPORTAL_BI_FILE_IMPORT_STEP_2 }}<br><br>\n\n\t\t\t<div class=\"form-group row\">\n\t\t\t\t<label for=\"example-input-2\" class=\"col-2 col-form-label\">{{ messages.RS_B2BPORTAL_BI_FILE_IMPORT_ARTICLE }}</label>\n\t\t\t\t<div class=\"col-10\">\n\t\t\t\t\t<select class=\"form-control\" id=\"example-input-2\" v-model=\"settings.codeIndex\">\n\t\t\t\t\t\t<option :value=\"undefined\">-</option>\n\t\t\t\t\t\t<option v-for=\"i in fileData.highestColumn\" :key=\"i\" :value=\"i\" :disabled=\"i === settings.quantityIndex\">{{ i }} ({{ fileRows[0][i - 1] }})</option>\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"form-group row\">\n\t\t\t\t<label for=\"example-input-2\" class=\"col-2 col-form-label\">{{ messages.RS_B2BPORTAL_BI_FILE_IMPORT_QUANTITY }}</label>\n\t\t\t\t<div class=\"col-10\">\n\t\t\t\t\t<select class=\"form-control\" id=\"example-input-2\" v-model=\"settings.quantityIndex\">\n\t\t\t\t\t\t<option :value=\"undefined\">-</option>\n\t\t\t\t\t\t<option v-for=\"i in fileData.highestColumn\" :key=\"i\"  :value=\"i\" :disabled=\"i === settings.codeIndex\">{{ i }} ({{ fileRows[0][i - 1] }})</option>\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"form-group row\">\n\t\t\t\t<div class=\"col-10 offset-2\">\n\t\t\t\t\t<label class=\"kt-checkbox\">\n\t\t\t\t\t\t<input type=\"checkbox\" v-model=\"skipFirstRow\"> {{ messages.RS_B2BPORTAL_BI_FILE_IMPORT_SKIP_FIRST_ROW }}\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<a class=\"btn btn-primary pull-right\" @click.prevent.stop=\"next(step)\" href=\"#\"> {{ messages.RS_B2BPORTAL_BI_FILE_IMPORT_NEXT }} </a>\n\t\t\t<a class=\"btn btn-btn-outline-brand pull-right\" @click.prevent.stop=\"back(step)\" href=\"#\">{{ messages.RS_B2BPORTAL_BI_FILE_IMPORT_BACK }}</a>\n\t\t</template>\n\n\t\t<template v-slot:step3=\"step3\">\n\t\t\t{{ messages.RS_B2BPORTAL_BI_FILE_IMPORT_STEP_3 }}<br><br>\n\n\t\t\t<div v-if=\"!!result\">\n\t\t\t\t<div v-for=\"(basketResult, code) in result\" :key=\"code\">\n\t\t\t\t\t<span :class=\"{'text-success': basketResult.isSuccess, 'text-danger': !basketResult.isSuccess}\">{{code}}: {{ basketResult.message }} </span>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<br><br>\n\n\t\t\t<a class=\"btn btn-primary pull-right\" @click.prevent.stop=\"reset()\" href=\"#\"> {{messages.RS_B2BPORTAL_BI_FILE_IMPORT_RESET}} </a>\n\t\t</template>\n\n\t</Stepper>\n\n</template>\n\n<script>\nimport { parseFile, addtobasket} from './api.js';\n\nexport default {\n\n\tcomponents: {\n\t\tStepper: B2BPortal.Vue.Components.Stepper\n\t},\n\n\tprops: {\n\t\tsignedParameters: {\n\t\t\ttype: String,\n\t\t\tdefault: ''\n\t\t}\n\t},\n\n\tdata()\n\t{\n\t\treturn {\n\t\t\tcurrentStepIndex: 0,\n\t\t\tsteps: Object.freeze([\n\t\t\t\t'step1',\n\t\t\t\t'step2',\n\t\t\t\t'step3'\n\t\t\t]),\n\t\t\tmethod: 'upload',\n\t\t\tfile: '',\n\t\t\tfilePath: '',\n\t\t\tfileRows: [],\n\t\t\tskipFirstRow: true,\n\t\t\tsettings: {\n\t\t\t\tcodeIndex: undefined,\n\t\t\t\tquantityIndex: undefined\n\t\t\t},\n\t\t\tresult: {}\n\t\t}\n\t},\n\n\tcomputed: {\n\n\t\tfileData()\n\t\t{\n\t\t\treturn {\n\t\t\t\thighestColumn: this.fileRows.reduce((highest, row) => Math.max(highest, row.length), 0)\n\t\t\t};\n\t\t},\n\n\t\tmessages()\n\t\t{\n\t\t\treturn (\n\t\t\t\tObject.freeze(\n\t\t\t\t\tObject.keys(BX.message).filter(message => message.startsWith('RS_B2BPORTAL_BI'))\n\t\t\t\t\t\t.reduce((obj, message) => { obj[message.slice(message)] = BX.message(message); return obj; }, {})\n\t\t\t\t)\n\t\t\t);\n\t\t},\n\t},\n\n\tmethods: {\n\t\treset()\n\t\t{\n\t\t\tthis.currentStepIndex = 0;\n\t\t\tthis.fileRows = [];\n\t\t\tthis.file = '';\n\t\t\tthis.filePath = '';\n\n\t\t\tthis.settings = {\n\t\t\t\tcodeIndex: undefined,\n\t\t\t\tquantityIndex: undefined\n\t\t\t}\n\n\t\t\tthis.result = {};\n\t\t},\n\n\t\tstartLoader()\n\t\t{\n\t\t\tthis.$emit('startLoader')\n\t\t},\n\n\t\tendLoader()\n\t\t{\n\t\t\tthis.$emit('endLoader')\n\t\t},\n\n\t\tvalidateFileInput()\n\t\t{\n\t\t\tconst fileInput = this.$refs.fileInput;\n\t\t\tconst file = (fileInput.files || [])[0];\n\n\t\t\tthis.filePath = fileInput.value;\n\n\t\t\tif (file)\n\t\t\t{\n\t\t\t\tfileInput.classList.remove('is-invalid');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfileInput.classList.add('is-invalid');\n\t\t\t}\n\t\t},\n\n\t\thandleStep(step)\n\t\t{\n\t\t\tthis.currentStepIndex = step.index;\n\t\t},\n\n\t\tasync next(step)\n\t\t{\n\t\t\tswitch(step.name)\n\t\t\t{\n\t\t\t\tcase 'step1':\n\n\t\t\t\t\ttry \n\t\t\t\t\t{\n\t\t\t\t\t\tthis.startLoader();\n\n\t\t\t\t\t\tif (await this.processReadFile())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstep.next();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {}\n\t\t\t\t\tfinally\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.endLoader();\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'step2':\n\n\t\t\t\t\ttry \n\t\t\t\t\t{\n\t\t\t\t\t\tthis.startLoader();\n\t\t\t\t\t\tstep.next();\n\t\t\t\t\t\tawait this.addtobasket();\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {}\n\t\t\t\t\tfinally\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.endLoader();\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n\t\tasync back(step)\n\t\t{\n\t\t\tstep.back();\n\t\t},\n\n\t\tasync processReadFile()\n\t\t{\n\t\t\tif (this.method === 'upload')\n\t\t\t{\n\t\t\t\treturn this.processReadFileByUpload();\n\t\t\t}\n\t\t\telse if (this.method === 'link')\n\t\t\t{\n\t\t\t\treturn this.processReadFileByPath();\n\t\t\t}\n\n\t\t\tthrow new Error('Wrong file upload method');\n\t\t},\n\n\t\tasync processReadFileByUpload()\n\t\t{\n\t\t\tconst fileInput = this.$refs.fileInput;\n\t\t\tconst file = (fileInput.files || [])[0];\n\n\t\t\tif (file)\n\t\t\t{\n\t\t\t\tconst formData = new FormData();\n\t\t\t\tformData.append('file', file);\n\t\t\t\tformData.append('signedParamaters', this.signedParameters);\n\t\t\t\tformData.append('sessid', BX.bitrix_sessid());\n\n\t\t\t\tthis.fileRows = await parseFile(formData);\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfileInput.classList.add('is-invalid');\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\n\t\tasync processReadFileByPath()\n\t\t{\n\t\t\tthis.fileRows = await parseFile({\n\t\t\t\tpath: this.filePath,\n\t\t\t\tsignedParameters: this.signedParameters\n\t\t\t});\n\n\t\t\treturn true;\n\t\t},\n\n\t\tprepareData()\n\t\t{\n\t\t\tlet data = {};\n\t\t\tconst rows=  [...this.fileRows];\n\n\t\t\tif (this.skipFirstRow)\n\t\t\t{\n\t\t\t\trows.shift();\n\t\t\t}\n\n\t\t\tfor (const row of rows)\n\t\t\t{\n\t\t\t\tconst codeStr = new String(row[this.settings.codeIndex - 1]);\n\t\t\t\tif (codeStr.trim() !== '')\n\t\t\t\t{\n\t\t\t\t\tdata[codeStr] = row[this.settings.quantityIndex - 1];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn data;\n\t\t},\n\n\t\tasync addtobasket()\n\t\t{\n\t\t\tif (this.fileRows.length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst data = this.prepareData();\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst result = await addtobasket({\n\t\t\t\t\tdata: data,\n\t\t\t\t\tsignedParameters: this.signedParameters\t\n\t\t\t\t});\n\t\n\t\t\t\tthis.result = result;\n\t\t\t\tthis.$store.dispatch('cart/fetch');\n\t\t\t}\n\t\t\tcatch(e)\n\t\t\t{\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t}\n\t},\n\n\twatch: {\n\t\tfileRows(newVal)\n\t\t{\n\t\t\tif (this.fileRows.length > 0)\n\t\t\t{\n\t\t\t\tif ( this.fileRows[0].length === 5)\n\t\t\t\t{\n\t\t\t\t\t// default export\n\t\t\t\t\tthis.settings.codeIndex = 2;\n\t\t\t\t\tthis.settings.quantityIndex = 4;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.settings.codeIndex = this.fileRows[0].length > 0 ? 1 : undefined\n\t\t\t\t\tthis.settings.quantityIndex = this.fileRows[0].length > 1 ? 2 : undefined\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n} \n</script>\n","import FileImport from './FileImport.vue';\n\nconst { store } = B2BPortal;\n\nexport class BasketFileImport\n{\n\tconstructor(params)\n\t{\n\t\tthis._params = params;\n\t\tthis.el = params.el;\n\t\tthis.modal = params.modal;\n\t\tthis.signedParameters = params.signedParameters;\n\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tconst signedParameters = this.signedParameters;\n\n\t\tconst startLoader = () => KTApp.block(this.modal);\n\t\tconst endLoader = () => KTApp.unblock(this.modal);\n\n\t\tthis.component = new Vue({\n\t\t\tel: this.el,\n\t\t\tcomponents: { FileImport: FileImport },\n\t\t\ttemplate: `<FileImport ref=\"fileImport\" :signedParameters=\"signedParameters\"/>`,\n\t\t\tstore,\n\n\t\t\tdata()\n\t\t\t{\n\t\t\t\treturn { signedParameters }\n\t\t\t},\n\n\t\t\tmounted()\n\t\t\t{\n\t\t\t\tthis.$refs.fileImport.$on('startLoader', startLoader);\n\t\t\t\tthis.$refs.fileImport.$on('endLoader', endLoader);\n\t\t\t}\n\t\t});\n\t}\n} "],"names":["action","actionName","data","resultData","undefined","Promise","resolve","reject","BX","ajax","runComponentAction","mode","then","result","global","toastr","error","errors","message","addtobasket","onCustomEvent","parseFile","components","Stepper","B2BPortal","Vue","Components","props","signedParameters","type","String","currentStepIndex","steps","Object","freeze","method","file","filePath","fileRows","skipFirstRow","settings","codeIndex","quantityIndex","computed","fileData","highestColumn","reduce","highest","row","Math","max","length","messages","keys","filter","startsWith","obj","slice","methods","reset","startLoader","$emit","endLoader","validateFileInput","fileInput","$refs","files","value","classList","remove","add","handleStep","step","index","next","name","processReadFile","back","processReadFileByUpload","processReadFileByPath","Error","formData","FormData","append","bitrix_sessid","path","prepareData","rows","shift","codeStr","trim","$store","dispatch","console","watch","newVal","normalizeComponent","template","style","script","scopeId","isFunctionalTemplate","moduleIdentifier","shadowMode","createInjector","createInjectorSSR","createInjectorShadow","options","render","staticRenderFns","_compiled","functional","_scopeId","hook","context","$vnode","ssrContext","parent","__VUE_SSR_CONTEXT__","call","_registeredComponents","_ssrRegister","$root","$options","shadowRoot","originalRender","renderWithStyleInjection","h","existing","beforeCreate","concat","normalizeComponent_1","store","BasketFileImport","params","_params","el","modal","init","KTApp","block","unblock","component","FileImport","mounted","fileImport","$on"],"mappings":"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"}